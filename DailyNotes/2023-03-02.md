2023-03-02 08:16
Parent:: [[Daily]] 
Parent:: xxxx





## Worked on

- [[DNS or Network issues cant connect]]
- [[MIX3K-9 MiX3000 Default Config Group]]

## Notes

```c#
public UpdateResult UpdateAssetConfigGroup(string authToken, long mobileUnitId, long configurationGroupId)
		{
			//the MobileUnit being sent in here is actually an asset ID  ( as we are setting/updating the config group for an asset)
			//TODO: Ek sal dalk hier ook net noem in toekoms wil ons potentially meer as een mobileunitid kan he per asset id... so mens moet nie die twee net uitruil nie - werk deur ander tabelle om die mobileunitid te kry
			try
			{
				...
				//Potentially this can all be removed
				//******
				var muCurr = _deviceConfigRepo.GetMobileUnit(mobileUnitId); 
				//TODO: Ja - ek dink soos jy gese het - die deel is dan nie nodig - noem ook die load is HUGE net om twee ids te kry...
				long orgId;
				long assetId;
				...
				//The old call had some logic about getting an impersonated session in some cases - we should investigate the impact on auditing if this is just removed
				//TODO: Ek sien in my kode was dit nodig om die fleet goed reg te roep met permissions... en deviceConfigRepo se add mobile te roep... ek DINK dis al...
				CurrentUserSession session = _authenticationProxy.GetSession(authToken);


				//The old call fetched a reduced set of information (potentially we should use_deviceConfigRepo.GetMobileUnitWithPropertiesOnly )
				var mu = _deviceConfigRepo.GetMobileUnitAggregate(mobileUnitId);

				//the below two calls gets the asset and org and then use those two objects to get the legacy id for the vehicle and the org
				// both of those values are avalable on the much lighter call _assetProxy.GetAssetSummary(orgId, assetId)  that was used in the orginal code being ported
				//TODO: JA - ekt ook die AssetsRepo.GetLegacyDetailsAsync gebruik
				var asset = _assetProxy.GetAsset(assetId);
				var org = _organisationsProxy.GetOrganisationSummary(orgId);

				...
				}
				else
				{
					if (configurationGroupId != mu.ConfigurationGroupId)
					{
						...

						//This method should make it clearer that is is only updateing the config group and config status for a mobileUnit
						//should it rather accept the values that it will change?  is it creating the expectation that it will update anything on MU that you changed
						//TODO: On another note, sometimes we get a summary of something. In that entity it might show fields, which are not populated for that call... keep in mind
						_deviceConfigRepo.UpdateMobileUnit(session, mu);

						_assetProxy.UpdateAssetsConfigurationGroup(orgId, new List<long> { assetId }, configurationGroupId, newTemplate.LegacyUnitType);
					}
				}

				...
```





