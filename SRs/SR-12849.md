https://uk.mixtelematics.com/#/asset/diagnostics/MiX4000?
id=1241134095780491264
orgId=7990115690917630680
&device=MiX4000&modal=true

[[Command 45]]

{"CommandId":45,"Param1":3600,"Param2":7200,"Param3":1648346400,"ConfigVersion":null,"FirmwareVersion":null,"CommandType":null,"Value":""}


{"CommandId":45,"Param1":7200,"Param2":3600,"Param3":1667095200,"ConfigVersion":null,"FirmwareVersion":null,"CommandType":null,"Value":""}

orgSecondsOffset = 3600
 
 site before: 7200 (3600)
 after:3600 (0)
ctime: Oct 30th






Step 1: First set all Orgs DST with "[dynamix].[OrgOptions_UpdateDST]"
	Look in log for:
	updating Germany Bahnen der Stadt Monheim
Step 2: Update assets in sites
	Look in log for:
	Updating organisation Germany Bahnen der Stadt Monheim


Which FMs were sent
	[dynamix].[Messages_GetDSTCommandsForLastYear]
		SELECT DISTINCT
		    [AssetId],
		    [dtStarts] as [DtStarts],
		    [sParams] as [SParams]
		  FROM [dbo].[Messages] m WITH (NOLOCK)
		    INNER JOIN [dynamix].[Assets] a WITH (NOLOCK) ON m.iVehicleID = a.VehicleId
		  WHERE REPLACE(sParams, ' ', '') LIKE 'CommandID=45;%'
		    AND dtStarts >= DATEADD(YEAR, -1, @now)
		    AND (dtExpires >= @now
		      OR (dtExpires < @now AND ucState = 9))
Which MESAs were sent
	[state].[MobileUnitMessages_GetDSTCommandsForLastYear]
		SELECT DISTINCT   
		    msg.MobileUnitId MobileUnitId, 
		    [CreationDateUtc] CreationDateUtc, 
		    ParamsJson
		  FROM [state].[MobileUnitMessage] msg
		    INNER JOIN [state].[MobileUnitMessageStateHistory] msgh ON msgh.MessageKey = msg.MessageKey
		  WHERE REPLACE(ParamsJson, ' ', '') LIKE '%"CommandId":45,%'
		    AND CreationDateUtc >= DATEADD(YEAR, -1, @now)
		    AND (ExpiryDateUtc >= @now
		      OR (ExpiryDateUtc < @now AND msgh.MessageStatus in (13, 25)))

ONCE SENT
	Logger.Log(string.Format("Received SendCommandToMobileUnit Request (groupId={0}, mobileUnitId={1}, commandId={2}, preferredTransport={3}, param1={4}, param2={5}, param3={6})", groupId, mobileUnitId, (CommandIdType)commandId, preferredTransport, param1, param2, param3), LogLevel.Debug);
	
		Received SendCommandToMobileUnit Request (groupId=7990115690917630680, mobileUnitId=1241134095780491264

		\\hsdubiis23\l$\WebServices
		\\hsdubiis24\l$\WebServices
		\\hsdubiis55\l$\WebServices

